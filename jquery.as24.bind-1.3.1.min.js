(function(f){var j=f.attr;f.attr=function(b,c,a,d){var e=this,g=f.isPlainObject(b);void 0===a?e=g?b[c]:j(b,c,a,d):g?(d=b[c],b[c]=a,f(b).trigger({type:"change."+c,attribute:c,newValue:a,oldValue:d}),f(b).trigger({type:"change",attribute:c,newValue:a,oldValue:d})):j(b,c,a,d);return e};getBindingType=function(b){b=f(b);if(0<b.length)switch(b=b[0],b.nodeName){case "INPUT":switch(b.type){case "hidden":case "password":return"text";case "reset":case "submit":return"button";default:return b.type}case "SELECT":return b.multiple?
"multiselect":"dropdown";case "BUTTON":return"button";case "TEXTAREA":return"text"}return"property"};bindToView=function(b,c,a){a();f(b).bind("change."+c,a);return b};bindToProperty=function(b,c,a,d,e){return bindToView(b,c,function(){var g=f(b).attr(c);void 0!==e&&(g=e(g));var h="function"===typeof a?a(g):f(a);switch(d){case void 0:case "val":h.val(g);break;case "text":h.text(g);break;default:h.attr(d,g)}})};bindToRadio=function(b,c,a,d){return bindToView(b,c,function(){var e=f(b).attr(c);void 0!==
d&&(e=d(e));f(a).attr("checked",!1);f(a).filter("[value='"+e+"']").attr("checked",!0)})};bindToMoreVals=function(b,c,a,d){void 0===d&&(d=function(b){f(a).val(b)});return bindToView(b,c,function(){var a=f(b).attr(c).split(",");d(a)})};bindToCheckBox=function(b,c,a,d){return bindToMoreVals(b,c,a,function(b){f(a).attr("checked",!1);f.each(b,function(b,c){void 0!==d&&(c=d(c));f(a).filter("[value='"+c+"']").attr("checked",!0)})})};bindToMultiSelect=function(b,c,a,d){return bindToMoreVals(b,c,a,function(b){if(void 0!==
d)for(i=0;i<b.length;i++)b[i]=d(b[i]);f(a).val(b)})};bindFromView=function(b,c,a,d){c="function"===typeof c?c(value):f(c);a();d||(d="change");c.bind(d,a);return b};bindFromProperty=function(b,c,a,d,e,g,h){void 0===d&&(d=a);return bindFromView(b,a,function(){var a="function"===typeof d?d():f(d);switch(e){case void 0:case "val":a=a.val();break;case "text":a=a.text();break;default:a=a.attr(e)}void 0!==g&&(a=g(a));f(b).attr(c,a)},h)};bindFromRadio=function(b,c,a,d,e){return bindFromProperty(b,c,a,function(){return f(a).filter(":checked")},
"val",d,e)};bindFromButton=function(b,c,a,d,e){a="function"===typeof a?a():f(a);e||(e="click");a.bind(e,function(){var a="function"===typeof d?d(this.value):this.value;f(b).attr(c,a)});return b};bindFromCheckBox=function(b,c,a,d,e){return bindFromView(b,a,function(){var e=[];f.each(f(a).filter(":checked"),function(a,b){e[a]=b.value;void 0!==d&&(e[a]=d(e[a]))});f(b).attr(c,e.join(","))},e)};bindFromMultiSelect=function(b,c,a,d,e){return bindFromView(b,a,function(){var e=[];null!=f(a).val()&&f.each(f(a).val(),
function(a,b){e[a]=b;void 0!==d&&(e[a]=d(e[a]))});f(b).attr(c,e.join(","))},e)};f.fn.extend({getBindingType:getBindingType,dataBind:function(b){var c=b.modelAttribute,a=b.selector,d=b.translateTo,e=b.translateFrom,f=b.domProperty,h=b.initialDataInDom,b=b.eventToBind;switch(getBindingType(a)){case "radio":h?(bindFromRadio(this,c,a,e,b),bindToRadio(this,c,a,d)):(bindToRadio(this,c,a,d),bindFromRadio(this,c,a,e,b));break;case "checkbox":h?(bindFromCheckBox(this,c,a,e,b),bindToCheckBox(this,c,a,d)):(bindToCheckBox(this,
c,a,d),bindFromCheckBox(this,c,a,e,b));break;case "multiselect":h?(bindFromMultiSelect(this,c,a,e,b),bindToMultiSelect(this,c,a,d)):(bindToMultiSelect(this,c,a,d),bindFromMultiSelect(this,c,a,e,b));break;case "button":bindFromButton(this,c,a,e,b);break;case "text":case "dropdown":f||(f="val");default:f||(f="text"),h?(bindFromProperty(this,c,a,a,f,e,b),bindToProperty(this,c,a,f,d)):(bindToProperty(this,c,a,f,d),bindFromProperty(this,c,a,a,f,e,b))}return this}})})(jQuery);
